<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Example workflows - jenkins-action-poc</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Example workflows | jenkins-action-poc</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Example workflows" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="This is the POC of Jenkinsfile Runner Action for GitHub Actions in GSoC 2022." /> <meta property="og:description" content="This is the POC of Jenkinsfile Runner Action for GitHub Actions in GSoC 2022." /> <link rel="canonical" href="http://localhost:4000/docs/user-guide/example-workflows.html" /> <meta property="og:url" content="http://localhost:4000/docs/user-guide/example-workflows.html" /> <meta property="og:site_name" content="jenkins-action-poc" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Example workflows" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"This is the POC of Jenkinsfile Runner Action for GitHub Actions in GSoC 2022.","headline":"Example workflows","url":"http://localhost:4000/docs/user-guide/example-workflows.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> jenkins-action-poc </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/user-guide" class="nav-list-link">User Guide</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/user-guide/prerequisites.html" class="nav-list-link">Prerequisites</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/user-guide/inputs.html" class="nav-list-link">Inputs</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/user-guide/actions-cmp.html" class="nav-list-link">Actions Comparisons</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/user-guide/step-by-step-usage.html" class="nav-list-link">Step by step usage</a></li><li class="nav-list-item active"><a href="http://localhost:4000/docs/user-guide/example-workflows.html" class="nav-list-link active">Example workflows</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/user-guide/advanced-usage.html" class="nav-list-link">Advanced usage</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/user-guide/demo.html" class="nav-list-link">Demo</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/developer-guide" class="nav-list-link">Developer Guide</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/developer-guide/background-information.html" class="nav-list-link">Background information</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/developer-guide/test-change.html" class="nav-list-link">How to test the source code</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/developer-guide/action-contribution.html" class="nav-list-link">How to contribute to the actions repos</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/developer-guide/demo-contribution.html" class="nav-list-link">How to contribute to the demo repo</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search jenkins-action-poc" aria-label="Search jenkins-action-poc" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/user-guide">User Guide</a></li> <li class="breadcrumb-nav-list-item"><span>Example workflows</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="example-workflows"> <a href="#example-workflows" class="anchor-heading" aria-labelledby="example-workflows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example workflows </h1> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#container-job-action" id="markdown-toc-container-job-action">Container job action</a></li> <li><a href="#docker-container-action" id="markdown-toc-docker-container-action">Docker container action</a></li> <li><a href="#runtime-action" id="markdown-toc-runtime-action">Runtime action</a></li> </ol> <p>There are three common cases about how to play with these actions. Although the user interfaces are similar to each other, there are still some subtle differences. The runtime actions are deprecated now. The users can use the <a href="#container-job-action">jfr-container-action</a> and <a href="#docker-container-action">jfr-static-image-action</a>.</p> <h2 id="container-job-action"> <a href="#container-job-action" class="anchor-heading" aria-labelledby="container-job-action"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Container job action </h2> <p>This case is realized by jfr-container-action. If the job uses this action, it will run the Jenkins pipeline and other GitHub Actions in the prebuilt container provided by <a href="https://github.com/jenkinsci/jenkinsfile-runner/pkgs/container/jenkinsfile-runner">ghcr.io/jenkinsci/jenkinsfile-runner:master</a>. The <strong>extra prerequisite</strong> of this action is that you need to declare the image usage of ghcr.io/jenkinsci/jenkinsfile-runner:master at the start of the job.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Java CI</span>
<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">]</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">jenkins-container-pipeline</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">jenkins-prebuilt-container-test</span>
    <span class="na">container</span><span class="pi">:</span>
      <span class="c1"># prerequisite</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">ghcr.io/jenkinsci/jenkinsfile-runner:master</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
      <span class="c1"># jfr-container-action</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Jenkins pipeline in the container</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">jenkins_pipeline_container</span>
        <span class="na">uses</span><span class="pi">:</span>
          <span class="s">Cr1t-GYM/jenkins-action-poc/jfr-container-action@master</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">command</span><span class="pi">:</span> <span class="s">run</span>
          <span class="na">jenkinsfile</span><span class="pi">:</span> <span class="s">Jenkinsfile</span>
          <span class="na">pluginstxt</span><span class="pi">:</span> <span class="s">plugins.txt</span>
          <span class="na">jcasc</span><span class="pi">:</span> <span class="s">jcasc.yml</span>
</code></pre></div></div> <p>Some users might want to configure the container environment. The recommendation is that you should extend the <a href="https://github.com/jenkinsci/jenkinsfile-runner/pkgs/container/jenkinsfile-runner">ghcr.io/jenkinsci/jenkinsfile-runner:master</a> vanilla image and then you need to build and push it to your own registry. Finally, you can replace the vanilla image with your own custimized image. The invocation of jfr-container-action can be done in a similar way.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Java CI</span>
<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">]</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">jenkins-container-pipeline</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">jenkins-prebuilt-container-test</span>
    <span class="na">container</span><span class="pi">:</span>
      <span class="c1"># prerequisite: extendance of ghcr.io/jenkinsci/jenkinsfile-runner:master</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">path/to/your_own_image</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
      <span class="c1"># jfr-container-action</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Jenkins pipeline in the container</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">jenkins_pipeline_container</span>
        <span class="na">uses</span><span class="pi">:</span>
          <span class="s">Cr1t-GYM/jenkins-action-poc/jfr-container-action@master</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">command</span><span class="pi">:</span> <span class="s">run</span>
          <span class="na">jenkinsfile</span><span class="pi">:</span> <span class="s">Jenkinsfile</span>
          <span class="na">pluginstxt</span><span class="pi">:</span> <span class="s">plugins.txt</span>
          <span class="na">jcasc</span><span class="pi">:</span> <span class="s">jcasc.yml</span>
</code></pre></div></div> <h2 id="docker-container-action"> <a href="#docker-container-action" class="anchor-heading" aria-labelledby="docker-container-action"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Docker container action </h2> <p>This case is realized by jfr-static-image-action. This action has its own working environment. It wonâ€™t have extra environment relationship with the on demand VM outside unless the user mounts other directories to the container (For example, checkout action if exists). After the docker action ends, this container will be deleted. The users may check the introduction of <a href="https://docs.github.com/en/actions/creating-actions/creating-a-docker-container-action#introduction">Docker container action</a> before using this action.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Java CI</span>
<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">]</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">jenkins-static-image-pipeline</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">jenkins-static-image-pipeline-test</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
      <span class="c1"># jfr-static-image-action</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Jenkins pipeline with the static image</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">jenkins_pipeline_image</span>
        <span class="na">uses</span><span class="pi">:</span>
          <span class="s">Cr1t-GYM/jenkins-action-poc/jfr-static-image-action@master</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">command</span><span class="pi">:</span> <span class="s">run</span>
          <span class="na">jenkinsfile</span><span class="pi">:</span> <span class="s">Jenkinsfile</span>
          <span class="na">pluginstxt</span><span class="pi">:</span> <span class="s">plugins.txt</span>
          <span class="na">jcasc</span><span class="pi">:</span> <span class="s">jcasc.yml</span>
</code></pre></div></div> <h2 id="runtime-action"> <a href="#runtime-action" class="anchor-heading" aria-labelledby="runtime-action"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Runtime action </h2> <p>This case is realized by the combination of jenkins-setup, jenkins-plugin-installation-action and jenkinsfile-runner-action. It will download all the dependencies and run the pipeline at the host machine directly. Its advantage is that it can support Linux, macOS and Windows runners. Its main disadvantage is the possibility of suffering from a plugins.jenkins.io outage.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Java CI</span>
<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">]</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">jenkins-runtime-pipeline</span><span class="pi">:</span>
    <span class="c1"># Run all the actions in the on demand VM.</span>
    <span class="na">needs</span><span class="pi">:</span> <span class="s">syntax-check</span>
    <span class="na">strategy</span><span class="pi">:</span>
      <span class="na">matrix</span><span class="pi">:</span>
        <span class="na">os</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">ubuntu-latest</span><span class="pi">,</span> <span class="nv">macOS-latest</span><span class="pi">,</span> <span class="nv">windows-latest</span><span class="pi">]</span>    
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">$</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">jenkins-runtime-pipeline-test</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
      <span class="pi">-</span> <span class="na">name </span><span class="pi">:</span> <span class="s">Setup Jenkins</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">Cr1t-GYM/jenkins-action-poc/jenkins-setup</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Jenkins plugins download</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">jenkins_plugins_download</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">Cr1t-GYM/jenkins-action-poc/jenkins-plugin-installation-action</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">pluginstxt</span><span class="pi">:</span> <span class="s">jenkins-setup/plugins.txt</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Run Jenkins pipeline</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">run_jenkins_pipeline</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">Cr1t-GYM/jenkins-action-poc/jenkinsfile-runner-action</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">command</span><span class="pi">:</span> <span class="s">run</span>
          <span class="na">jenkinsfile</span><span class="pi">:</span> <span class="s">Jenkinsfile</span>
          <span class="na">jcasc</span><span class="pi">:</span> <span class="s">jcasc.yml</span>
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
